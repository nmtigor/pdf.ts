!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).wretchThrottlingCacheMiddleware={})}(this,(function(e){"use strict";const t=(e,t)=>t.skipCache||"GET"!==t.method,n=(e,t)=>t.method+"@"+e,o=(e,t)=>0,c=(e,t)=>null,i=e=>e.ok;e.throttlingCache=({throttle:e=1e3,skip:r=t,key:s=n,clear:a=o,invalidate:h=c,condition:l=i,flagResponseOnCacheHit:f="__cached"}={})=>{const d=new Map,u=new Map,p=new Set,g=t=>{e&&!p.has(t)&&(p.add(t),setTimeout((()=>{p.delete(t)}),e))},m=e=>(t,n)=>{const o=s(t,n);let c=h(t,n);if(c&&(c instanceof Array||(c=[c]),c.forEach((e=>{"string"==typeof e?d.delete(e):e instanceof RegExp&&d.forEach(((t,n)=>{e.test(n)&&d.delete(n)}))}))),a(t,n)&&d.clear(),r(t,n))return e(t,n);if(p.has(o)){if(d.has(o)){const e=d.get(o).clone();return f&&Object.defineProperty(e,f,{value:o,enumerable:0}),Promise.resolve(e)}if(u.has(o))return new Promise(((e,t)=>{u.get(o).push([e,t])}))}return u.has(o)||u.set(o,[]),g(o),e(t,n).then((e=>(l(e.clone())&&d.set(o,e.clone()),u.get(o).forEach((([t])=>t(e.clone()))),u.delete(o),e))).catch((e=>{throw u.get(o).forEach((([t,n])=>n(e))),u.delete(o),e}))};return m.cacheResponse=function(e,t){g(e),d.set(e,t)},m.cache=d,m.inflight=u,m.throttling=p,m}}));
//# sourceMappingURL=throttlingCache.min.js.map
